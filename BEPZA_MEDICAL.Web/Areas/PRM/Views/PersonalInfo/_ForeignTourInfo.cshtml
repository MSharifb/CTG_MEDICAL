@model BEPZA_MEDICAL.Web.Areas.PRM.ViewModel.PersonalInfo.ForeignTourInfoViewModel

@using (Html.BeginForm("CreateOrEditForeignTourInfo", "PersonalInfo", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    <fieldset>
        <div class="message">
            @if (!string.IsNullOrEmpty(Model.Message))
            {
                <div class="@Model.errClass">
                    @Model.Message
                </div>
            }
            @Html.ValidationSummary(false, BEPZA_MEDICAL.Web.Utility.Common.ValidationSummaryHead)
        </div>
        @Html.HiddenFor(model => model.EmployeeId)
        @Html.HiddenFor(model => model.Id)
        @Html.HiddenFor(model => model.strMode)
        @Html.Partial("_EmpTopInfo", Model.EmpTop)

        <div class="GroupBox">

            <div class="row">
                <span class="label">
                    @Html.LabelFor(model => model.TitleOfTheTour)<label class="required-field">
                        *
                    </label>
                </span><span class="field" style="width:70%">
                    @Html.EditorFor(model => model.TitleOfTheTour)
                </span>               
            </div>

            <div class="row">
                <span class="label">
                    @Html.LabelFor(model => model.VisitDateFrom)
                </span><span class="field">
                    @Html.EditorFor(model => model.VisitDateFrom)
                </span>
                <span class="label-right">
                    @Html.LabelFor(model => model.VisitDateTo)
                </span><span class="field">
                    @Html.EditorFor(model => model.VisitDateTo)
                </span>
            </div>

            <div class="row">
                <span class="label">
                    @Html.LabelFor(model => model.Financed)
                </span>
                <span class="field">
                    @Html.EditorFor(model => model.Financed)
                </span>
                <span class="label-right">
                    @Html.LabelFor(model => model.OrganizedBy)
                </span><span class="field">
                    @Html.EditorFor(model => model.OrganizedBy)
                </span>
            </div>

            <div class="row">
                <span class="label">
                    @Html.LabelFor(model => model.CountryId)
                    <label class="required-field">
                        *
                    </label>
                </span><span class="field">
                    @Html.DropDownListFor(model => model.CountryId, Model.CountryList, @String.Format("{0}", Content.DDLOptionalLabel()))
                </span>

                <span class="label-right">
                    @Html.LabelFor(model => model.Remarks)
                </span><span class="field">
                    @Html.TextAreaFor(model => model.Remarks)
                </span>
            </div>
            <div class="clear">
            </div>

        </div>
        <div class="GroupBox">
            <div class="clear"></div>
            <div class="row">
                <div id="divFileAttach">
                    <span class="label">
                        @Html.LabelFor(model => model.Attachment)
                    </span>
                    <span class="field">
                        @Html.HiddenFor(model => model.Attachment)
                        @Html.HiddenFor(model => model.FileName)
                        <input type="file" name="Attachment" id="Attachment" />
                        <a href="@Model.FilePath" visible="true" runat="server" target="_blank">@Model.FileName</a>
                    </span>
                </div>
            </div>
            <div class="clear"></div>
        </div>

        <div class="button-crude">
            @if ((new BEPZA_MEDICAL.Web.Utility.AppConstant()).IsEditAssigned || (new BEPZA_MEDICAL.Web.Utility.AppConstant()).IsAddAssigned)
            {
                <input type="submit" value="@Model.ButtonText" />
            }
            @if (!(new BEPZA_MEDICAL.Web.Utility.AppConstant()).IsViewAssigned)
            {
                @Html.ActionLink("Clear", "ForeignTourInfoIndex/" + @Model.EmployeeId.ToString(), new { IsMenu = true })
            }
            @if (Model.DeleteEnable && (new BEPZA_MEDICAL.Web.Utility.AppConstant()).IsAddAssigned)
            {
                @Html.ActionLink("Delete", "DeleteForeignTourInfo", new { id = Model.Id }, new { @class = "delete-confirm" })
            }
        </div>
        <div class="spacer">
        </div>
        <div class="spacer">
        </div>
        <table id="jqGrid" cellpadding="0" cellspacing="0"></table>
        <div id="jqGridPager" style="text-align: center;">
        </div>
        @Html.Partial("_ForeignTourList", Model)
    </fieldset>
}
<div class="button-crude button-left">
    @Html.ActionLink("Back to List", "Index")
</div>

<script type="text/javascript">
    function DeleteConfirm() {

        return confirm('Pressing OK will delete this record. Do you want to continue?')
    }

    $(document).ready(function () {

        $("#VisitDateTo").live('change', function () {
            $('#VisitDateTo').removeClass('border-red');
            var from = $('#VisitDateFrom').val();
            var to = $('#VisitDateTo').val();
            getDate(from, to);
        })

        $("#VisitDateFrom").live('change', function () {
            $('#VisitDateFrom').removeClass('border-red');
            var from = $('#VisitDateFrom').val();
            var to = $('#VisitDateTo').val();
            getDate(from, to);
        })

        function getDate(from, to) {
            $('.message').empty();
            if ((new Date(from).getTime() > new Date(to).getTime())) {
                $(".message").html("<div class=\"validation-summary-errors\" data-valmsg-summary=\"true\"> <span>'Visit Date To' must be greater than or equal to 'Visit Date From'.</span> </div> ");
                $('#VisitDateTo').val('');
                $('#VisitDateTo').addClass('border-red');
                $('#VisitDateFrom').addClass('border-red');
                return;
            }
        }
    });
</script>

<script type="text/javascript">
    $(document).ready(function () {
        $("form").submit(function () {
            $(".message").empty();

            if ($('#TitleOfTheTour').val() == '' || $('#TitleOfTheTour').val() == null) {
                $(".message").html("<div class=\"validation-summary-errors\" data-valmsg-summary=\"true\"> <span> Please fill up the red marked field(s)</span>  </div> ");
                return false;
            }
            else if ($('#CountryId').val() == '' || $('#CountryId').val() == null || $('#CountryId').val() == 0) {
                $(".message").html("<div class=\"validation-summary-errors\" data-valmsg-summary=\"true\"> <span> Please fill up the red marked field(s)</span>  </div> ");
                return false;
            }
        });
    });
</script>



