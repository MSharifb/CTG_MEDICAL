
@model BEPZA_MEDICAL.Web.Areas.CPF.Models.ProfitDistribution.ProfitDistributionViewModel

@{
    ViewBag.Title = "Index";
    Layout = "~/Areas/CPF/Views/Shared/_Layout.cshtml";
}

<script src="@Url.Content("~/Scripts/listEditor.js")" type="text/javascript"></script>

@using (Ajax.BeginForm("GetDetailList", "ProfitDistribution", new AjaxOptions { HttpMethod = "POST" }, new { id = "frm" }))
{
    <fieldset>
        <div class="GroupBox">
            <div id="message">
                @if (!string.IsNullOrEmpty(Model.Message))
                {
                    <div class="success">
                        @Model.Message
                    </div>
                }
            </div>
        </div>

        <fieldset>
            <div class="row">
                @*<span class="label">
                    @Html.LabelFor(model => model.Period)
                </span>
                <span class="field">
                    @Html.TextBoxFor(y => y.Period, new { @class = "read-only", @readonly = true })
                </span>*@
                <span class="label-right">
                    @Html.LabelFor(model => model.ProfitRate)
                </span><span class="field">
                    @Html.TextBoxFor(model => model.ProfitRate, new { @class = "read-only", @readonly = true })
                </span>
            </div>

        </fieldset>

        <div class="clear">
        </div>
        <fieldset>
            <legend>Search</legend>
            <div id="jqSearch">
            </div>
            <div class="clear">
            </div>
        </fieldset>
        <table id="jqGrid" cellpadding="0" cellspacing="0"></table>
        <div id="jqGridPager" style="text-align: center;">
        </div>
        <div id="divList">
            @Html.Partial("_DetailGridList", Model)
        </div>

        <div>
            **** (C): Company Portion    ||       (E): Employee Portion
        </div>
        @*<div class="col-sm-3 col-sm-offset-1 text-right" style="float:right">
            <button type="submit" class="btn btn-success" id="btnVoucherPosting" onclick="ProfitVoucherPosting()">
                <i class="fa fa-file-powerpoint-o"></i> Prepare Profit Voucher
            </button>
        </div>*@
    </fieldset>
}
<div class="button-crude button-left">
    @Html.ActionLink("Back to List", "Index")

</div>
<script type="text/javascript">
    function ProfitVoucherPosting() {

        var id = $("#id").val();
        if (id < 0) {
            alert('Before prepare voucher, please process distribution for this month.');
            return false;
        }
        var url = '@Url.Action("ProfitVoucherPosting", "ProfitDistribution")?id=' + id;
        $.ajax({
            url: url,
            type: 'POST',
            success: function (result) {
                if (result.redirectUrl != '') {
                    window.location.href = result.redirectUrl;
                }
            },
            error: function () {
                alert('System is unable to load data please try again.');
            }
        });
    }
</script>